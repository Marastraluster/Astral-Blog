import{_ as a,c as i,o as t,af as e}from"./chunks/framework.W5ZyBR1w.js";const g=JSON.parse('{"title":"🌐 使用哪吒探针与宝塔面板实现家中服务器公网访问（非内网穿透方案）","description":"","frontmatter":{},"headers":[],"relativePath":"Notes/Web.md","filePath":"Notes/Web.md"}'),l={name:"Notes/Web.md"};function h(n,s,d,r,p,o){return t(),i("div",null,[...s[0]||(s[0]=[e(`<h1 id="🌐-使用哪吒探针与宝塔面板实现家中服务器公网访问-非内网穿透方案" tabindex="-1">🌐 使用哪吒探针与宝塔面板实现家中服务器公网访问（非内网穿透方案） <a class="header-anchor" href="#🌐-使用哪吒探针与宝塔面板实现家中服务器公网访问-非内网穿透方案" aria-label="Permalink to “🌐 使用哪吒探针与宝塔面板实现家中服务器公网访问（非内网穿透方案）”">​</a></h1><p><strong>作者</strong>：Martin Zeng<br><strong>系统环境</strong>：</p><ul><li>VPS：Debian 系统</li><li>域名：<code>astraluster.top</code></li><li>家庭服务器：待配置（将通过哪吒 Agent 接入）</li></ul><hr><h2 id="🧩-一、项目目标" tabindex="-1">🧩 一、项目目标 <a class="header-anchor" href="#🧩-一、项目目标" aria-label="Permalink to “🧩 一、项目目标”">​</a></h2><p>通过 <strong>哪吒探针（Nezha Dashboard + Agent）</strong> 与 <strong>宝塔面板（BT Panel）</strong> 实现如下架构：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>https://home.astraluster.top</span></span>
<span class="line"><span>   ↓</span></span>
<span class="line"><span>[Nginx (宝塔面板)] ———&gt; [哪吒探针 Dashboard (VPS)]</span></span>
<span class="line"><span>   ↑</span></span>
<span class="line"><span>[哪吒 Agent (家中服务器)]</span></span>
<span class="line"><span>   ↑</span></span>
<span class="line"><span>[家庭局域网服务，如 http://localhost:8080]</span></span></code></pre></div><p><strong>实现目标：</strong></p><ul><li>无需使用内网穿透（如 frp、ngrok）</li><li>家中服务器主动连接 VPS</li><li>VPS 提供统一的公网访问入口（域名 + SSL）</li><li>所有流量可控、安全且稳定</li></ul><hr><h2 id="⚙️-二、vps-上安装哪吒探针面板" tabindex="-1">⚙️ 二、VPS 上安装哪吒探针面板 <a class="header-anchor" href="#⚙️-二、vps-上安装哪吒探针面板" aria-label="Permalink to “⚙️ 二、VPS 上安装哪吒探针面板”">​</a></h2><h3 id="_1️⃣-安装哪吒面板-dashboard" tabindex="-1">1️⃣ 安装哪吒面板（Dashboard） <a class="header-anchor" href="#_1️⃣-安装哪吒面板-dashboard" aria-label="Permalink to “1️⃣ 安装哪吒面板（Dashboard）”">​</a></h3><p>在 Debian VPS 上执行：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://raw.githubusercontent.com/naiba/nezha/master/script/install.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./nezha.sh</span></span></code></pre></div><p>选择：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>1) 安装面板 (Dashboard)</span></span></code></pre></div><p>安装完成后输出：</p><ul><li>管理后台访问端口（默认 <code>8008</code>）</li><li>登录账户与密码</li><li>配置文件路径：<code>/opt/nezha/dashboard/config.yaml</code></li></ul><hr><h3 id="_2️⃣-启用反向代理功能" tabindex="-1">2️⃣ 启用反向代理功能 <a class="header-anchor" href="#_2️⃣-启用反向代理功能" aria-label="Permalink to “2️⃣ 启用反向代理功能”">​</a></h3><p>编辑配置文件：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/nezha/dashboard/config.yaml</span></span></code></pre></div><p>修改或添加：</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">reverse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  enable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  listen_port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5555</span></span></code></pre></div><p>保存并退出，重启哪吒面板：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-dashboard</span></span></code></pre></div><hr><h2 id="🧱-三、在-vps-上安装宝塔面板" tabindex="-1">🧱 三、在 VPS 上安装宝塔面板 <a class="header-anchor" href="#🧱-三、在-vps-上安装宝塔面板" aria-label="Permalink to “🧱 三、在 VPS 上安装宝塔面板”">​</a></h2><h3 id="_1️⃣-安装宝塔面板-bt-panel" tabindex="-1">1️⃣ 安装宝塔面板（BT Panel） <a class="header-anchor" href="#_1️⃣-安装宝塔面板-bt-panel" aria-label="Permalink to “1️⃣ 安装宝塔面板（BT Panel）”">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -O</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://download.bt.cn/install/install_panel.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bash</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install.sh</span></span></code></pre></div><p>安装后系统会显示：</p><ul><li>宝塔访问地址（如 <code>http://&lt;VPS_IP&gt;:8888</code>）</li><li>登录账号和密码</li></ul><p>用浏览器访问并登录宝塔后台。</p><hr><h3 id="_2️⃣-添加网站与-ssl-证书" tabindex="-1">2️⃣ 添加网站与 SSL 证书 <a class="header-anchor" href="#_2️⃣-添加网站与-ssl-证书" aria-label="Permalink to “2️⃣ 添加网站与 SSL 证书”">​</a></h3><ol><li><p>打开「网站」 → 「添加站点」<br> 填写以下信息：</p><ul><li><strong>域名</strong>：<code>home.astraluster.top</code></li><li><strong>根目录</strong>：<code>/www/wwwroot/home.astraluster.top</code></li><li>勾选「创建网站」</li></ul></li><li><p>打开网站设置 → 「SSL」</p><ul><li>选择「Let&#39;s Encrypt」</li><li>勾选「自动续签」</li><li>域名填写 <code>home.astraluster.top</code></li><li>点击「申请证书」</li></ul></li></ol><p>申请成功后，HTTPS 自动启用。</p><hr><h3 id="_3️⃣-配置反向代理-nginx" tabindex="-1">3️⃣ 配置反向代理（Nginx） <a class="header-anchor" href="#_3️⃣-配置反向代理-nginx" aria-label="Permalink to “3️⃣ 配置反向代理（Nginx）”">​</a></h3><ol><li>打开宝塔 → 「网站」 → 选择 <code>home.astraluster.top</code> → 「反向代理」</li><li>点击「添加反向代理」： <ul><li><strong>代理名称</strong>：<code>nezha</code></li><li><strong>目标 URL</strong>：<code>http://127.0.0.1:8008</code></li><li>勾选「启用反向代理」</li></ul></li><li>保存并应用。</li></ol><p>此时访问：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>https://home.astraluster.top</span></span></code></pre></div><p>即可打开哪吒探针面板。<br> （后台路径 <code>/admin</code>）</p><hr><h2 id="🏠-四、在家中服务器部署哪吒-agent" tabindex="-1">🏠 四、在家中服务器部署哪吒 Agent <a class="header-anchor" href="#🏠-四、在家中服务器部署哪吒-agent" aria-label="Permalink to “🏠 四、在家中服务器部署哪吒 Agent”">​</a></h2><p>当家庭服务器可用后，在终端中执行：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://raw.githubusercontent.com/naiba/nezha/master/script/install.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./nezha.sh</span></span></code></pre></div><p>选择：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>2) 安装Agent</span></span></code></pre></div><p>输入以下信息：</p><ul><li><strong>服务器地址</strong>：<code>astraluster.top</code></li><li><strong>端口</strong>：<code>5555</code></li><li><strong>节点 Token</strong>：从哪吒面板后台复制生成</li></ul><p>安装完成后，Agent 会自动连接到 VPS。 在哪吒面板的「节点管理」中可看到该节点显示为“在线”。</p><hr><h2 id="🔄-五、配置反代通道-哪吒面板操作" tabindex="-1">🔄 五、配置反代通道（哪吒面板操作） <a class="header-anchor" href="#🔄-五、配置反代通道-哪吒面板操作" aria-label="Permalink to “🔄 五、配置反代通道（哪吒面板操作）”">​</a></h2><ol><li>打开哪吒面板后台 → 「节点管理」</li><li>找到刚上线的家中服务器节点</li><li>点击「反向代理」 → 「添加反代」</li><li>按下表填写：</li></ol><table tabindex="0"><thead><tr><th>字段</th><th>示例值</th><th>说明</th></tr></thead><tbody><tr><td>名称</td><td>homeweb</td><td>自定义名称</td></tr><tr><td>绑定域名</td><td><code>blog.astraluster.top</code></td><td>为家中服务创建子域名</td></tr><tr><td>路径</td><td><code>/</code></td><td>根路径</td></tr><tr><td>目标节点</td><td>家中服务器</td><td>选择对应节点</td></tr><tr><td>本地服务地址</td><td><code>http://127.0.0.1:8080</code></td><td>家中实际服务端口</td></tr></tbody></table><ol start="5"><li>在域名服务商中添加 DNS 记录：</li></ol><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>blog.astraluster.top → VPS公网IP</span></span></code></pre></div><p>完成后访问：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>https://blog.astraluster.top</span></span></code></pre></div><p>即可访问家中服务器提供的网页。</p><hr><h2 id="🔐-六、安全与维护建议" tabindex="-1">🔐 六、安全与维护建议 <a class="header-anchor" href="#🔐-六、安全与维护建议" aria-label="Permalink to “🔐 六、安全与维护建议”">​</a></h2><table tabindex="0"><thead><tr><th>安全项</th><th>建议</th></tr></thead><tbody><tr><td>哪吒面板端口</td><td>仅允许本地访问 (<code>127.0.0.1</code>)，通过宝塔反代访问</td></tr><tr><td>VPS 防火墙</td><td>放行端口：<code>443</code>（HTTPS）、<code>5555</code>（Agent 通道）</td></tr><tr><td>SSL 证书</td><td>使用宝塔 Let&#39;s Encrypt 自动续签</td></tr><tr><td>Token 保密</td><td>不公开节点密钥</td></tr><tr><td>系统更新</td><td>定期执行 <code>apt update &amp;&amp; apt upgrade</code></td></tr><tr><td>日志清理</td><td>定期清理 <code>/opt/nezha/dashboard/logs/</code></td></tr></tbody></table><hr><h2 id="🧰-七、目录与端口结构汇总" tabindex="-1">🧰 七、目录与端口结构汇总 <a class="header-anchor" href="#🧰-七、目录与端口结构汇总" aria-label="Permalink to “🧰 七、目录与端口结构汇总”">​</a></h2><table tabindex="0"><thead><tr><th>服务</th><th>运行位置</th><th>端口</th><th>路径</th></tr></thead><tbody><tr><td>哪吒面板 Dashboard</td><td>VPS</td><td>8008</td><td><code>/opt/nezha/dashboard/</code></td></tr><tr><td>哪吒反代通道</td><td>VPS</td><td>5555</td><td>配置于 <code>config.yaml</code></td></tr><tr><td>宝塔 Nginx</td><td>VPS</td><td>443</td><td><code>/www/wwwroot/home.astraluster.top</code></td></tr><tr><td>哪吒 Agent</td><td>家中服务器</td><td>出站连接</td><td><code>/opt/nezha/agent/</code></td></tr><tr><td>家中 Web 服务</td><td>家中服务器</td><td>8080</td><td>本地网站或应用</td></tr></tbody></table><hr><h2 id="🪄-八、后续拓展建议" tabindex="-1">🪄 八、后续拓展建议 <a class="header-anchor" href="#🪄-八、后续拓展建议" aria-label="Permalink to “🪄 八、后续拓展建议”">​</a></h2><ul><li><p>✅ 为不同服务添加多个子域名：</p><ul><li><code>nas.astraluster.top</code> → 家中 NAS</li><li><code>media.astraluster.top</code> → 家中影视服务器</li><li><code>blog.astraluster.top</code> → 个人网站</li></ul></li><li><p>✅ 结合 Docker Compose 管理家中多服务，统一接入哪吒。</p></li><li><p>✅ 使用 Cloudflare 或 DNSPod 提升域名解析速度与安全性。</p></li></ul><hr><h2 id="📘-总结" tabindex="-1">📘 总结 <a class="header-anchor" href="#📘-总结" aria-label="Permalink to “📘 总结”">​</a></h2><p>通过 <strong>哪吒探针（自建反向代理） + 宝塔面板（SSL + Nginx 管理）</strong>，<br> 你可以轻松让家中服务器拥有公网可访问的网站，无需购买固定 IP、无需第三方穿透。</p><p>该方案具有：</p><ul><li>🧩 <strong>自控性高</strong>（完全掌握链路与数据）</li><li>🧠 <strong>部署简单</strong>（宝塔面板图形化操作）</li><li>🔒 <strong>安全稳定</strong>（出站连接 + HTTPS）</li><li>🌐 <strong>可拓展性强</strong>（多节点、多服务接入）</li></ul><hr><p><strong>下一步建议：</strong> 等你的家庭服务器配置完成后，可以：</p><ol><li>启动 Agent 并注册到面板；</li><li>配置反代子域名；</li><li>我可以帮你生成自动化命令与备份脚本。</li></ol><hr><blockquote><p>📄 版本号：v1.0<br> 🗓️ 更新日期：2025-11-10<br> 🧑‍💻 作者：Martin Zeng</p></blockquote>`,80)])])}const c=a(l,[["render",h]]);export{g as __pageData,c as default};
